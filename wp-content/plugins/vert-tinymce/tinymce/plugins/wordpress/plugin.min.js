tinymce.PluginManager.add("wordpress",function(a){function b(b){var c,d,h,i=0;d="hide"===b,a.theme.panel&&(h=a.theme.panel.find(".toolbar:not(.menubar)")),!h||h.length<2||"hide"===b&&!h[1].visible()||(!b&&h[1].visible()&&(b="hide"),g(h,function(a,c){c>0&&("hide"===b?(a.hide(),i+=30):(a.show(),i-=30))}),i&&!d&&(tinymce.Env.iOS||(c=a.getContentAreaContainer().firstChild,f.setStyle(c,"width",c.clientWidth+i)),"hide"===b?(setUserSetting("hidetb","0"),e&&this.active(!1)):(setUserSetting("hidetb","1"),e&&this.active(!0))),a.fire("wp-toolbar-toggle"))}function c(){}tinymce.ui.FloatPanel.zIndex=100100;var d,e=!1,f=tinymce.DOM,g=tinymce.each,h=a.editorManager.i18n.translate,i=window.jQuery,j=window.wp,k=j&&j.editor&&j.editor.autop&&a.getParam("wpautop",!0);return i&&i(document).triggerHandler("tinymce-editor-setup",[a]),a.addButton("wp_adv",{tooltip:"Toolbar Toggle",cmd:"WP_Adv",onPostRender:function(){e=!0,this.active("1"===getUserSetting("hidetb"))}}),a.on("PostRender",function(){a.getParam("wordpress_adv_hidden",!0)&&"0"===getUserSetting("hidetb","0")&&b("hide")}),a.addCommand("WP_Adv",function(){b()}),a.on("focus",function(){window.wpActiveEditor=a.id}),a.on("BeforeSetContent",function(a){var b;a.content&&(-1!==a.content.indexOf("<!--more")&&(b=h("Read more..."),a.content=a.content.replace(/<!--more(.*?)-->/g,function(a,c){return'<img src="'+tinymce.Env.transparentSrc+'" data-wp-more="more" data-wp-more-text="'+c+'" class="wp-more-tag mce-wp-more" alt="" title="'+b+'" data-mce-resize="false" data-mce-placeholder="1" />'})),-1!==a.content.indexOf("<!--nextpage-->")&&(b=h("Page break"),a.content=a.content.replace(/<!--nextpage-->/g,'<img src="'+tinymce.Env.transparentSrc+'" data-wp-more="nextpage" class="wp-more-tag mce-wp-nextpage" alt="" title="'+b+'" data-mce-resize="false" data-mce-placeholder="1" />')),a.load&&"raw"!==a.format&&k&&(a.content=j.editor.autop(a.content)),a.content=a.content.replace(/<p>([^<>]+)<\/p>/gi,function(a,b){return/^(&nbsp;|\s|\u00a0|\ufeff)+$/i.test(b)?"<p><br /></p>":a}))}),a.on("PostProcess",function(a){a.get&&(a.content=a.content.replace(/<img[^>]+>/g,function(a){var b,c="";return-1!==a.indexOf('data-wp-more="more"')?(a.match(/data-wp-more-text="([^"]+)"/)&&(b=a.match(/data-wp-more-text="([^"]+)"/),c=b[1]),a="<!--more"+c+"-->"):-1!==a.indexOf('data-wp-more="nextpage"')&&(a="<!--nextpage-->"),a}))}),a.on("ResolveName",function(b){var c;"IMG"===b.target.nodeName&&(c=a.dom.getAttrib(b.target,"data-wp-more"))&&(b.name=c)}),a.addCommand("WP_More",function(b){var c,d,e,f="wp-more-tag",g=a.dom,i=a.selection.getNode();return b=b||"more",f+=" mce-wp-"+b,e="more"===b?"Read more...":"Next page",e=h(e),d='<img src="'+tinymce.Env.transparentSrc+'" alt="" title="'+e+'" class="'+f+'" data-wp-more="'+b+'" data-mce-resize="false" data-mce-placeholder="1" />',"BODY"===i.nodeName||"P"===i.nodeName&&"BODY"===i.parentNode.nodeName?void a.insertContent(d):(c=g.getParent(i,function(a){return!(!a.parentNode||"BODY"!==a.parentNode.nodeName)},a.getBody()),void(c&&("P"===c.nodeName?c.appendChild(g.create("p",null,d).firstChild):g.insertAfter(g.create("p",null,d),c),a.nodeChanged())))}),a.addCommand("WP_Code",function(){a.formatter.toggle("code")}),a.addCommand("WP_Page",function(){a.execCommand("WP_More","nextpage")}),a.addCommand("WP_Help",function(){function b(a){var b="<tr>";return g(a,function(a,c){b+=a?"<td><kbd>"+c+"</kbd></td><td>"+h(a)+"</td>":"<td></td><td></td>"}),b+"</tr>"}var c,d,e,f,i=h(tinymce.Env.mac?"Ctrl + Alt + letter:":"Shift + Alt + letter:"),j=h(tinymce.Env.mac?"Cmd + letter:":"Ctrl + letter:"),k=[],l=[];g([{c:"Copy",x:"Cut"},{v:"Paste",a:"Select all"},{z:"Undo",y:"Redo"},{b:"Bold",i:"Italic"},{o:"Overerline",k:"Insert/edit link"}],function(a){k.push(b(a))}),g([{1:"Heading 1",2:"Heading 2"},{3:"Heading 3",4:"Heading 4"},{5:"Heading 5",6:"Heading 6"},{l:"Align left",c:"Align center"},{r:"Align right",j:"Justify"},{d:"Strikethrough",q:"Blockquote"},{u:"Bullet list",o:"Numbered list"},{a:"Insert/edit link",s:"Remove link"},{m:"Insert/edit image",t:"Insert Read More tag"},{h:"Keyboard Shortcuts",x:"Code"},{p:"Insert Page Break tag",w:"Distraction-free writing mode"}],function(a){l.push(b(a))}),c=[h("Letter"),h("Action"),h("Letter"),h("Action")],c="<tr><th>"+c.join("</th><th>")+"</th></tr>",d='<div class="wp-editor-help">',d=d+"<h2>"+h("Default shortcuts,")+" "+j+'</h2><table class="wp-help-th-center fixed">'+c+k.join("")+"</table><h2>"+h("Additional shortcuts,")+" "+i+'</h2><table class="wp-help-th-center fixed">'+c+l.join("")+"</table>",a.plugins.wptextpattern&&(!tinymce.Env.ie||tinymce.Env.ie>8)&&(d=d+"<h2>"+h("When starting a new paragraph with one of these formatting shortcuts followed by a space, the formatting will be applied automatically. Press Backspace or Escape to undo.")+'</h2><table class="wp-help-th-center fixed">'+b({"*":"Bullet list","1.":"Numbered list"})+b({"-":"Bullet list","1)":"Numbered list"})+"</table>",d=d+"<h2>"+h("The following formatting shortcuts are replaced when pressing Enter. Press Escape or the Undo button to undo.")+'</h2><table class="wp-help-single">'+b({">":"Blockquote"})+b({"##":"Heading 2"})+b({"###":"Heading 3"})+b({"####":"Heading 4"})+b({"#####":"Heading 5"})+b({"######":"Heading 6"})+b({"---":"Horizontal line"})+"</table>"),d=d+"<h2>"+h("Focus shortcuts:")+'</h2><table class="wp-help-single">'+b({"Alt + F8":"Inline toolbar (when an image, link or preview is selected)"})+b({"Alt + F9":"Editor menu (when enabled)"})+b({"Alt + F10":"Editor toolbar"})+b({"Alt + F11":"Elements path"})+"</table><p>"+h("To move focus to other buttons use Tab or the arrow keys. To return focus to the editor press Escape or use one of the buttons.")+"</p>",d+="</div>",e=a.windowManager.open({title:"Keyboard Shortcuts",items:{type:"container",classes:"wp-help",html:d},buttons:{text:"Close",onclick:"close"}}),e.$el&&(e.$el.find('div[role="application"]').attr("role","document"),f=e.$el.find(".mce-wp-help"),f[0]&&(f.attr("tabindex","0"),f[0].focus(),f.on("keydown",function(a){a.keyCode>=33&&a.keyCode<=40&&a.stopPropagation()})))}),a.addCommand("WP_Medialib",function(){j&&j.media&&j.media.editor&&j.media.editor.open(a.id)}),a.addButton("wp_more",{tooltip:"Insert Read More tag",onclick:function(){a.execCommand("WP_More","more")}}),a.addButton("wp_page",{tooltip:"Page break",onclick:function(){a.execCommand("WP_More","nextpage")}}),a.addButton("wp_help",{tooltip:"Keyboard Shortcuts",cmd:"WP_Help"}),a.addButton("wp_code",{tooltip:"Code",cmd:"WP_Code",stateSelector:"code"}),j&&j.media&&j.media.editor&&a.addMenuItem("add_media",{text:"Add Media",icon:"wp-media-library",context:"insert",cmd:"WP_Medialib"}),a.addMenuItem("wp_more",{text:"Insert Read More tag",icon:"wp_more",context:"insert",onclick:function(){a.execCommand("WP_More","more")}}),a.addMenuItem("wp_page",{text:"Page break",icon:"wp_page",context:"insert",onclick:function(){a.execCommand("WP_More","nextpage")}}),a.on("BeforeExecCommand",function(b){!tinymce.Env.webkit||"InsertUnorderedList"!==b.command&&"InsertOrderedList"!==b.command||(d||(d=a.dom.create("style",{type:"text/css"},"#tinymce,#tinymce span,#tinymce li,#tinymce li>span,#tinymce p,#tinymce p>span{font:medium sans-serif;color:#000;line-height:normal;}")),a.getDoc().head.appendChild(d))}),a.on("ExecCommand",function(b){tinymce.Env.webkit&&d&&("InsertUnorderedList"===b.command||"InsertOrderedList"===b.command)&&a.dom.remove(d)}),a.on("init",function(){var b=tinymce.Env,c=["mceContentBody"],d=a.getDoc(),e=a.dom;b.iOS&&e.addClass(d.documentElement,"ios"),e.setAttrib(d.documentElement,"lang",a.getParam("wp_lang_attr")),b.ie?9===parseInt(b.ie,10)?c.push("ie9"):8===parseInt(b.ie,10)&&c.push("ie8"):b.webkit&&c.push("webkit"),c.push("wp-editor"),g(c,function(a){a&&e.addClass(d.body,a)}),a.on("BeforeSetContent",function(a){a.content&&(a.content=a.content.replace(/<p>\s*<(p|div|ul|ol|dl|table|blockquote|h[1-6]|fieldset|pre)( [^>]*)?>/gi,"<$1$2>").replace(/<\/(p|div|ul|ol|dl|table|blockquote|h[1-6]|fieldset|pre)>\s*<\/p>/gi,"</$1>"))}),i&&i(document).triggerHandler("tinymce-editor-init",[a]),window.tinyMCEPreInit&&window.tinyMCEPreInit.dragDropUpload&&e.bind(d,"dragstart dragend dragover drop",function(a){i&&i(document).trigger(new i.Event(a))}),a.getParam("wp_paste_filters",!0)&&(a.on("PastePreProcess",function(a){a.content=a.content.replace(/<br class="?Apple-interchange-newline"?>/gi,""),tinymce.Env.webkit||(a.content=a.content.replace(/(<[^>]+) style="[^"]*"([^>]*>)/gi,"$1$2"),a.content=a.content.replace(/(<[^>]+) data-mce-style=([^>]+>)/gi,"$1 style=$2"))}),a.on("PastePostProcess",function(a){g(e.select("p",a.node),function(a){e.isEmpty(a)&&e.remove(a)})}))}),a.on("SaveContent",function(b){return!a.inline&&a.isHidden()?void(b.content=b.element.value):(b.content=b.content.replace(/<p>(?:<br ?\/?>|\u00a0|\uFEFF| )*<\/p>/g,"<p>&nbsp;</p>"),void(k&&(b.content=j.editor.removep(b.content))))}),a.on("preInit",function(){var b="@[id|accesskey|class|dir|lang|style|tabindex|title|contenteditable|draggable|dropzone|hidden|spellcheck|translate],i,b,script[src|async|defer|type|charset|crossorigin|integrity]";a.schema.addValidElements(b),tinymce.Env.iOS&&(a.settings.height=300),g({c:"JustifyCenter",r:"JustifyRight",l:"JustifyLeft",j:"JustifyFull",q:"mceBlockQuote",u:"InsertUnorderedList",o:"InsertOrderedList",s:"unlink",m:"WP_Medialib",z:"WP_Adv",t:"WP_More",d:"Strikethrough",h:"WP_Help",p:"WP_Page",x:"WP_Code"},function(b,c){a.shortcuts.add("access+"+c,"",b)}),a.addShortcut("meta+s","",function(){j&&j.autosave&&j.autosave.server.triggerSave()}),window.getUserSetting("editor_plain_text_paste_warning")>1&&(a.settings.paste_plaintext_inform=!1)}),a.on("PastePlainTextToggle",function(a){if(a.state===!0){var b=parseInt(window.getUserSetting("editor_plain_text_paste_warning"),10)||0;2>b&&window.setUserSetting("editor_plain_text_paste_warning",++b)}}),a.on("preinit",function(){function b(b,c){function d(){if(!e)return this;var a=window.pageXOffset,b=window.pageYOffset,c=window.innerWidth,d=window.innerHeight;if(0>a||0>b){var g=a;a=-b,b=g}if(c>window.outerWidth||d>window.outerHeight){var h=c;c=d,d=h}var l,m,n=a,q=b,r=c,s=d,t=p?p.getBoundingClientRect():{top:0,right:r,bottom:s,left:0,width:r,height:s},u=this.getEl(),v=u.offsetWidth,w=u.offsetHeight,x=e.getBoundingClientRect(),y=(x.left+x.right)/2,z=5,A=8,B=v+A+z,C=o?o.getBoundingClientRect().right:0,D=i?i.getBoundingClientRect().right:0,E=j?r-j.getBoundingClientRect().left:0,F=k?r-k.getBoundingClientRect().left:0,G=Math.max(0,C,D,t.left),H=Math.max(0,E,F,r-t.right),I=x.left+t.left-G,J=r-t.left-x.right-H,K=r-G-H,L="",M=0,N=0;return I>=K||J>=K?(this.scrolling=!0,this.hide(),this.scrolling=!1,this):(tinymce.Env.iOS&&"IMG"===e.nodeName&&(M=54,N=46),this.right?J>=B?(L=" mce-arrow-up",m=x.right+t.left+n-N):I>=B&&(L=" mce-arrow-down",m=x.left+t.left+n-v-A+M):I>=B?(L=" mce-arrow-down",m=x.left+t.left+n-v-A+M):J>=B&&K/2>x.right+t.left-G&&(L=" mce-arrow-up",m=x.right+t.left+n-N),"undefined"==typeof m&&(m=n+G+z+N),l=y-w/2+t.top+q,x.top<0||x.bottom>t.height?l=t.top+q+(t.height-w)/2:w>=s?(L+=" mce-arrow-full",l=0):0>l&&x.top+w>s||l+w>s&&x.bottom-w<0?l=(s-w)/2:l<t.top+q?(L+=" mce-arrow-left",l=x.top+t.top+q):l+w>t.height+t.top+q&&(L+=" mce-arrow-right",l=x.bottom-w+t.top+q),tinymce.Env.iOS&&"IMG"===e.nodeName&&(L=L.replace(/ ?mce-arrow-(up|down)/g,"")),u.className=u.className.replace(/ ?mce-arrow-[\w]+/g,"")+L,f.setStyles(u,{left:m,top:l}),this)}var h,n,q=[];return g(b,function(b){function c(){var c=a.selection;"bullist"===d&&c.selectorChanged("ul > li",function(a,c){for(var d,e=c.parents.length;e--&&(d=c.parents[e].nodeName,"OL"!==d&&"UL"!=d););b.active(a&&"UL"===d)}),"numlist"===d&&c.selectorChanged("ol > li",function(a,c){for(var d,e=c.parents.length;e--&&(d=c.parents[e].nodeName,"OL"!==d&&"UL"!==d););b.active(a&&"OL"===d)}),b.settings.stateSelector&&c.selectorChanged(b.settings.stateSelector,function(a){b.active(a)},!0),b.settings.disabledStateSelector&&c.selectorChanged(b.settings.disabledStateSelector,function(a){b.disabled(a)})}var d;"|"===b?n=null:l.has(b)?(b={type:b},m.toolbar_items_size&&(b.size=m.toolbar_items_size),q.push(b),n=null):(n||(n={type:"buttongroup",items:[]},q.push(n)),a.buttons[b]&&(d=b,b=a.buttons[d],"function"==typeof b&&(b=b()),b.type=b.type||"button",m.toolbar_items_size&&(b.size=m.toolbar_items_size),b=l.create(b),n.items.push(b),a.initialized?c():a.on("init",c)))}),h=l.create({type:"panel",layout:"stack",classes:"toolbar-grp inline-toolbar-grp",ariaRoot:!0,ariaRemember:!0,items:[{type:"toolbar",layout:"flow",items:q}]}),h.bottom=c,h.on("show",function(){this.reposition()}),h.on("keydown",function(b){27===b.keyCode&&(this.hide(),a.focus())}),a.on("remove",function(){h.remove()}),h.reposition=d,h.hide().renderTo(document.body),h}function c(a){d&&(d.tempHide||"hide"===a.type?(d.hide(),d=!1):"resize"!==a.type&&"scroll"!==a.type||d.blockHide||(clearTimeout(h),h=setTimeout(function(){d&&"function"==typeof d.show&&(d.scrolling=!1,d.show())},250),d.scrolling=!0,d.hide()))}var d,e,h,i,j,k,l=tinymce.ui.Factory,m=a.settings,n=a.getContainer(),o=document.getElementById("wpadminbar"),p=document.getElementById(a.id+"_ifr");n&&(i=tinymce.$(".mce-toolbar-grp",n)[0],j=tinymce.$(".mce-statusbar",n)[0]),"content"===a.id&&(k=document.getElementById("post-status-info")),a.shortcuts.add("alt+119","",function(){var a;d&&(a=d.find("toolbar")[0],a&&a.focus(!0))}),a.on("nodechange",function(b){var c=a.selection.isCollapsed(),f={element:b.element,parents:b.parents,collapsed:c};a.fire("wptoolbar",f),e=f.selection||f.element,d&&d!==f.toolbar&&d.hide(),f.toolbar?d!==f.toolbar?(d=f.toolbar,d.show()):d.reposition():d=!1}),a.on("focus",function(){d&&d.show()}),f.bind(window,"resize scroll",c),a.dom.bind(a.getWin(),"resize scroll",c),a.on("remove",function(){f.unbind(window,"resize scroll",c),a.dom.unbind(a.getWin(),"resize scroll",c)}),a.on("blur hide",c),a.wp=a.wp||{},a.wp._createToolbar=b},!0),{_showButtons:c,_hideButtons:c,_setEmbed:c,_getEmbed:c}});