tinymce.PluginManager.add("wpemoji",function(a){function b(a){a.className="emoji",a.setAttribute("data-mce-resize","false"),a.setAttribute("data-mce-placeholder","1"),a.setAttribute("data-wp-emoji","1")}function c(a){var b={"data-mce-resize":"false","data-mce-placeholder":"1","data-wp-emoji":"1"};f.emoji.parse(a,{imgAttr:b})}function d(b){var d,e;b&&window.twemoji&&window.twemoji.test(b.textContent||b.innerText)&&(h.webkit&&(d=a.selection,e=d.getBookmark()),c(b),h.webkit&&d.moveToBookmark(e))}var e,f=window.wp,g=window._wpemojiSettings,h=tinymce.Env,i=window.navigator.userAgent,j=i.indexOf("Windows")>-1,k=function(){var a=i.match(/Windows NT 6\.(\d)/);return!!(a&&a[1]>1)}();f&&f.emoji&&!g.supports.everything&&(k?a.on("keyup",function(b){231===b.keyCode&&d(a.selection.getNode())}):j||(a.on("keydown keyup",function(a){e="keydown"===a.type}),a.on("input",function(){e||d(a.selection.getNode())})),a.on("setcontent",function(b){var d=a.selection,e=d.getNode();window.twemoji&&window.twemoji.test(e.textContent||e.innerText)&&(c(e),h.ie&&h.ie<9&&b.load&&e&&"BODY"===e.nodeName&&d.collapse(!0))}),a.on("PastePostProcess",function(c){window.twemoji&&tinymce.each(a.dom.$("img.emoji",c.node),function(a){a.alt&&window.twemoji.test(a.alt)&&b(a)})}),a.on("postprocess",function(a){a.content&&(a.content=a.content.replace(/<img[^>]+data-wp-emoji="[^>]+>/g,function(a){var b=a.match(/alt="([^"]+)"/);return b&&b[1]?b[1]:a}))}),a.on("resolvename",function(b){"IMG"===b.target.nodeName&&a.dom.getAttrib(b.target,"data-wp-emoji")&&b.preventDefault()}))});